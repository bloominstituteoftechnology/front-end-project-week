{"code":"import * as tslib_1 from \"tslib\";\r\nimport { Children, cloneElement, createElement } from 'react';\r\nimport { invariant, warning } from 'hey-listen';\r\nvar getKey = function (child) {\r\n    invariant(child && child.key !== null, 'Every child of Transition must be given a unique key');\r\n    var childKey = typeof child.key === 'number' ? child.key.toString() : child.key;\r\n    return childKey.replace('.$', '');\r\n};\r\nvar prependProps = function (element, props) {\r\n    return createElement(element.type, tslib_1.__assign({ key: element.key, ref: element.ref }, props, element.props));\r\n};\r\nvar handleTransition = function (_a, _b) {\r\n    var displayedChildren = _b.displayedChildren, finishedLeaving = _b.finishedLeaving, hasInitialized = _b.hasInitialized, prevChildren = _b.indexedChildren, scheduleChildRemoval = _b.scheduleChildRemoval;\r\n    var targetChildren = _a.children, preEnterPose = _a.preEnterPose, enterPose = _a.enterPose, exitPose = _a.exitPose, animateOnMount = _a.animateOnMount, enterAfterExit = _a.enterAfterExit, flipMove = _a.flipMove, onRest = _a.onRest, propsForChildren = tslib_1.__rest(_a, [\"children\", \"preEnterPose\", \"enterPose\", \"exitPose\", \"animateOnMount\", \"enterAfterExit\", \"flipMove\", \"onRest\"]);\r\n    targetChildren = makeChildList(targetChildren);\r\n    var nextState = {\r\n        displayedChildren: [],\r\n        indexedChildren: {},\r\n    };\r\n    if (process.env.NODE_ENV !== 'production') {\r\n        warning(!propsForChildren.onPoseComplete, \"<Transition/> (or <PoseGroup/>) doesn't accept onPoseComplete prop.\");\r\n    }\r\n    var prevKeys = displayedChildren.map(getKey);\r\n    var nextKeys = targetChildren.map(getKey);\r\n    var hasPropsForChildren = Object.keys(propsForChildren).length !== 0;\r\n    var entering = new Set(nextKeys.filter(function (key) { return finishedLeaving.hasOwnProperty(key) || prevKeys.indexOf(key) === -1; }));\r\n    entering.forEach(function (key) { return delete finishedLeaving[key]; });\r\n    var leaving = [];\r\n    var newlyLeaving = {};\r\n    prevKeys.forEach(function (key) {\r\n        if (entering.has(key)) {\r\n            return;\r\n        }\r\n        var isLeaving = finishedLeaving.hasOwnProperty(key);\r\n        if (!isLeaving && nextKeys.indexOf(key) !== -1) {\r\n            return;\r\n        }\r\n        leaving.push(key);\r\n        if (!isLeaving) {\r\n            finishedLeaving[key] = false;\r\n            newlyLeaving[key] = true;\r\n        }\r\n    });\r\n    var moving = new Set(prevKeys.filter(function (key, i) {\r\n        if (entering.has(key)) {\r\n            return false;\r\n        }\r\n        var nextIndex = nextKeys.indexOf(key);\r\n        return nextIndex !== -1 && i !== nextIndex;\r\n    }));\r\n    targetChildren.forEach(function (child) {\r\n        var newChildProps = {};\r\n        if (entering.has(child.key)) {\r\n            if (hasInitialized || animateOnMount) {\r\n                newChildProps.initialPose = preEnterPose;\r\n            }\r\n            newChildProps._pose = enterPose;\r\n        }\r\n        else if (moving.has(child.key) && flipMove) {\r\n            newChildProps._pose = [enterPose, 'flip'];\r\n        }\r\n        else {\r\n            newChildProps._pose = enterPose;\r\n        }\r\n        var newChild = cloneElement(child, newChildProps);\r\n        nextState.indexedChildren[child.key] = newChild;\r\n        nextState.displayedChildren.push(hasPropsForChildren\r\n            ? prependProps(newChild, propsForChildren)\r\n            : newChild);\r\n    });\r\n    leaving.forEach(function (key) {\r\n        var child = prevChildren[key];\r\n        var newChild = newlyLeaving[key]\r\n            ? cloneElement(child, {\r\n                _pose: exitPose,\r\n                onPoseComplete: function (pose) {\r\n                    scheduleChildRemoval(key);\r\n                    var onPoseComplete = child.props.onPoseComplete;\r\n                    onPoseComplete && onPoseComplete(pose);\r\n                },\r\n                popFromFlow: flipMove,\r\n            })\r\n            : child;\r\n        var insertionIndex = prevKeys.indexOf(key);\r\n        nextState.indexedChildren[child.key] = newChild;\r\n        nextState.displayedChildren.splice(insertionIndex, 0, hasPropsForChildren\r\n            ? prependProps(newChild, propsForChildren)\r\n            : newChild);\r\n    });\r\n    return nextState;\r\n};\r\nexport default (function (props, state) { return (tslib_1.__assign({ hasInitialized: true }, handleTransition(props, state))); });\r\nvar makeChildList = function (children) {\r\n    var list = [];\r\n    Children.forEach(children, function (child) { return child && list.push(child); });\r\n    return list;\r\n};\r\n//# sourceMappingURL=children.js.map","map":"{\"version\":3,\"file\":\"children.js\",\"sourceRoot\":\"\",\"sources\":[\"../../src/components/Transition/children.ts\"],\"names\":[],\"mappings\":\"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\"}"}
