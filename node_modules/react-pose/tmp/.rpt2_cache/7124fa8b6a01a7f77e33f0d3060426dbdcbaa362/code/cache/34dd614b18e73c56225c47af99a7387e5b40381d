{"code":"import * as tslib_1 from \"tslib\";\r\nimport * as React from 'react';\r\nimport { invariant } from 'hey-listen';\r\nvar Children = React.Children, cloneElement = React.cloneElement;\r\nvar filterChildProps = function (_a) {\r\n    var children = _a.children, _pose = _a._pose, onPoseComplete = _a.onPoseComplete, popFromFlow = _a.popFromFlow, props = tslib_1.__rest(_a, [\"children\", \"_pose\", \"onPoseComplete\", \"popFromFlow\"]);\r\n    return props;\r\n};\r\nvar getKey = function (child) {\r\n    invariant(child && child.key !== null, 'Every child of Transition must be given a unique key');\r\n    var childKey = typeof child.key === 'number' ? child.key.toString() : child.key;\r\n    return childKey.replace('.$', '');\r\n};\r\nvar handleTransition = function (_a, _b) {\r\n    var displayedChildren = _b.children, finishedLeaving = _b.finishedLeaving, scheduleChildRemoval = _b.scheduleChildRemoval, hasMounted = _b.hasMounted;\r\n    var targetChildren = _a.children, preEnterPose = _a.preEnterPose, enterPose = _a.enterPose, exitPose = _a.exitPose, animateOnMount = _a.animateOnMount, enterAfterExit = _a.enterAfterExit, flipMove = _a.flipMove, onRest = _a.onRest, propsForChild = tslib_1.__rest(_a, [\"children\", \"preEnterPose\", \"enterPose\", \"exitPose\", \"animateOnMount\", \"enterAfterExit\", \"flipMove\", \"onRest\"]);\r\n    targetChildren = makeChildList(targetChildren);\r\n    var children = [];\r\n    var prevKeys = displayedChildren.map(getKey);\r\n    var nextKeys = targetChildren.map(getKey);\r\n    var entering = new Set(nextKeys.filter(function (key) { return finishedLeaving.hasOwnProperty(key) || prevKeys.indexOf(key) === -1; }));\r\n    entering.forEach(function (key) { return delete finishedLeaving[key]; });\r\n    var leaving = prevKeys.filter(function (key) {\r\n        return !entering.has(key) &&\r\n            (finishedLeaving.hasOwnProperty(key) || nextKeys.indexOf(key) === -1);\r\n    });\r\n    leaving.forEach(function (key) { return (finishedLeaving[key] = false); });\r\n    var moving = new Set(prevKeys.filter(function (key, i) {\r\n        var nextIndex = nextKeys.indexOf(key);\r\n        return !entering.has(key) && nextIndex !== -1 && i !== nextIndex;\r\n    }));\r\n    targetChildren.forEach(function (child) {\r\n        var newChildProps = tslib_1.__assign({}, propsForChild, filterChildProps(child.props));\r\n        if (entering.has(child.key)) {\r\n            if (hasMounted || animateOnMount) {\r\n                newChildProps.initialPose = preEnterPose;\r\n            }\r\n            newChildProps._pose = enterPose;\r\n        }\r\n        else if (moving.has(child.key) && flipMove) {\r\n            newChildProps._pose = [enterPose, 'flip'];\r\n        }\r\n        else {\r\n            newChildProps._pose = enterPose;\r\n        }\r\n        children.push(cloneElement(child, newChildProps));\r\n    });\r\n    leaving.forEach(function (key) {\r\n        var child = displayedChildren.find(function (c) { return c.key === key; });\r\n        var newChild = cloneElement(child, tslib_1.__assign({ _pose: exitPose, onPoseComplete: function () { return scheduleChildRemoval(key); }, popFromFlow: flipMove }, propsForChild, filterChildProps(child.props)));\r\n        var insertionIndex = prevKeys.indexOf(key);\r\n        children.splice(insertionIndex, 0, newChild);\r\n    });\r\n    return { children: children };\r\n};\r\nexport default (function (props, state) { return (tslib_1.__assign({ hasMounted: true }, handleTransition(props, state))); });\r\nvar makeChildList = function (children) {\r\n    var list = [];\r\n    Children.forEach(children, function (child) { return child && list.push(child); });\r\n    return list;\r\n};\r\n//# sourceMappingURL=children.js.map","map":"{\"version\":3,\"file\":\"children.js\",\"sourceRoot\":\"\",\"sources\":[\"../../src/components/Transition/children.ts\"],\"names\":[],\"mappings\":\"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\"}"}
