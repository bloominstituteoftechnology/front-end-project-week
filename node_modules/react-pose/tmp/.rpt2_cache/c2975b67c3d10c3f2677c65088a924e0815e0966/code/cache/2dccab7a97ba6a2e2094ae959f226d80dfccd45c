{"code":"import * as React from 'react';\r\nvar Children = React.Children, cloneElement = React.cloneElement;\r\nvar getKey = function (child) { return child.key; };\r\nvar animateChildrenList = function (incomingChildren, pose, initialPose) {\r\n    var children = [];\r\n    Children.forEach(incomingChildren, function (child) {\r\n        return children.push(cloneElement(child, { pose: pose, initialPose: initialPose }));\r\n    });\r\n    return children;\r\n};\r\nvar mergeChildren = function (_a) {\r\n    var incomingChildren = _a.incomingChildren, displayedChildren = _a.displayedChildren, isLeaving = _a.isLeaving, removeFromTree = _a.removeFromTree, preEnterPose = _a.preEnterPose, enterPose = _a.enterPose, exitPose = _a.exitPose, flipMove = _a.flipMove;\r\n    var children = [];\r\n    var prevKeys = displayedChildren.map(getKey);\r\n    var nextKeys = incomingChildren.map(getKey);\r\n    var entering = new Set(nextKeys.filter(function (key) { return isLeaving.has(key) || prevKeys.indexOf(key) === -1; }));\r\n    entering.forEach(function (key) { return isLeaving.delete(key); });\r\n    var leaving = prevKeys.filter(function (key) {\r\n        return !entering.has(key) && (isLeaving.has(key) || nextKeys.indexOf(key) === -1);\r\n    });\r\n    leaving.forEach(function (key) { return isLeaving.add(key); });\r\n    var moving = new Set(prevKeys.filter(function (key, i) {\r\n        var nextIndex = nextKeys.indexOf(key);\r\n        return !entering.has(key) && nextIndex !== -1 && i !== nextIndex;\r\n    }));\r\n    incomingChildren.forEach(function (child) {\r\n        var newChildProps = entering.has(child.key)\r\n            ? { initialPose: preEnterPose, _pose: enterPose }\r\n            : moving.has(child.key) && flipMove\r\n                ? { _pose: [enterPose, 'flip'] }\r\n                : { _pose: enterPose };\r\n        children.push(cloneElement(child, newChildProps));\r\n    });\r\n    leaving.forEach(function (key) {\r\n        var child = displayedChildren.find(function (c) { return c.key === key; });\r\n        var newChild = cloneElement(child, {\r\n            _pose: exitPose,\r\n            onPoseComplete: removeFromTree(key),\r\n            popFromFlow: flipMove\r\n        });\r\n        var insertionIndex = prevKeys.indexOf(key);\r\n        if (insertionIndex) {\r\n        }\r\n        children.splice(insertionIndex, 0, newChild);\r\n    });\r\n    return children;\r\n};\r\nexport var handleIncomingChildren = function (props) {\r\n    var displayedChildren = props.displayedChildren, incomingChildren = props.incomingChildren, animateOnMount = props.animateOnMount, preEnterPose = props.preEnterPose, enterPose = props.enterPose;\r\n    if (!displayedChildren && animateOnMount) {\r\n        return animateChildrenList(incomingChildren, enterPose, preEnterPose);\r\n    }\r\n    else if (displayedChildren) {\r\n        return mergeChildren(props);\r\n    }\r\n    else {\r\n        return animateChildrenList(incomingChildren, enterPose);\r\n    }\r\n};\r\nexport var makeChildList = function (children) {\r\n    var list = [];\r\n    Children.forEach(children, function (child) { return child && list.push(child); });\r\n    return list;\r\n};\r\nexport var removeFromChildren = function (children, key) { return children.filter(function (child) { return child.key !== key; }); };\r\n//# sourceMappingURL=children.js.map","map":"{\"version\":3,\"file\":\"children.js\",\"sourceRoot\":\"\",\"sources\":[\"../src/utils/children.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,KAAK,KAAK,MAAM,OAAO,CAAC;AAGvB,IAAA,yBAAQ,EAAE,iCAAY,CAAW;AAczC,IAAM,MAAM,GAAG,UAAC,KAAwB,IAAa,OAAA,KAAK,CAAC,GAAa,EAAnB,CAAmB,CAAC;AAEzE,IAAM,mBAAmB,GAAG,UAC1B,gBAA0C,EAC1C,IAAiB,EACjB,WAAyB;IAEzB,IAAM,QAAQ,GAA6B,EAAE,CAAC;IAE9C,QAAQ,CAAC,OAAO,CAAC,gBAAgB,EAAE,UAAC,KAAwB;QAC1D,OAAA,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,EAAE,IAAI,MAAA,EAAE,WAAW,aAAA,EAAE,CAAC,CAAC;IAAzD,CAAyD,CAC1D,CAAC;IACF,OAAO,QAAQ,CAAC;AAClB,CAAC,CAAC;AAEF,IAAM,aAAa,GAAG,UAAC,EASF;QARnB,sCAAgB,EAChB,wCAAiB,EACjB,wBAAS,EACT,kCAAc,EACd,8BAAY,EACZ,wBAAS,EACT,sBAAQ,EACR,sBAAQ;IAER,IAAM,QAAQ,GAA6B,EAAE,CAAC;IAE9C,IAAM,QAAQ,GAAG,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;IAC/C,IAAM,QAAQ,GAAG,gBAAgB,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;IAE9C,IAAM,QAAQ,GAAG,IAAI,GAAG,CACtB,QAAQ,CAAC,MAAM,CAAC,UAAA,GAAG,IAAI,OAAA,SAAS,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAlD,CAAkD,CAAC,CAC3E,CAAC;IACF,QAAQ,CAAC,OAAO,CAAC,UAAA,GAAG,IAAI,OAAA,SAAS,CAAC,MAAM,CAAC,GAAG,CAAC,EAArB,CAAqB,CAAC,CAAC;IAE/C,IAAM,OAAO,GAAG,QAAQ,CAAC,MAAM,CAC7B,UAAA,GAAG;QACD,OAAA,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC;IAA1E,CAA0E,CAC7E,CAAC;IAEF,OAAO,CAAC,OAAO,CAAC,UAAA,GAAG,IAAI,OAAA,SAAS,CAAC,GAAG,CAAC,GAAG,CAAC,EAAlB,CAAkB,CAAC,CAAC;IAE3C,IAAM,MAAM,GAAG,IAAI,GAAG,CACpB,QAAQ,CAAC,MAAM,CAAC,UAAC,GAAG,EAAE,CAAC;QACrB,IAAM,SAAS,GAAG,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QACxC,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,SAAS,KAAK,CAAC,CAAC,IAAI,CAAC,KAAK,SAAS,CAAC;IACnE,CAAC,CAAC,CACH,CAAC;IAEF,gBAAgB,CAAC,OAAO,CAAC,UAAA,KAAK;QAC5B,IAAM,aAAa,GAAG,QAAQ,CAAC,GAAG,CAAC,KAAK,CAAC,GAAa,CAAC;YACrD,CAAC,CAAC,EAAE,WAAW,EAAE,YAAY,EAAE,KAAK,EAAE,SAAS,EAAE;YACjD,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,GAAa,CAAC,IAAI,QAAQ;gBAC3C,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,SAAS,EAAE,MAAM,CAAC,EAAE;gBAChC,CAAC,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,CAAC;QAE3B,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,aAAa,CAAC,CAAC,CAAC;IACpD,CAAC,CAAC,CAAC;IAEH,OAAO,CAAC,OAAO,CAAC,UAAA,GAAG;QACjB,IAAM,KAAK,GAAG,iBAAiB,CAAC,IAAI,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,GAAG,KAAK,GAAG,EAAb,CAAa,CAAC,CAAC;QACzD,IAAM,QAAQ,GAAG,YAAY,CAAC,KAAK,EAAE;YACnC,KAAK,EAAE,QAAQ;YACf,cAAc,EAAE,cAAc,CAAC,GAAG,CAAC;YACnC,WAAW,EAAE,QAAQ;SACtB,CAAC,CAAC;QAEH,IAAI,cAAc,GAAG,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QAK3C,IAAI,cAAc,EAAE;SAEnB;QAED,QAAQ,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC,EAAE,QAAQ,CAAC,CAAC;IAC/C,CAAC,CAAC,CAAC;IAEH,OAAO,QAAQ,CAAC;AAClB,CAAC,CAAC;AAEF,MAAM,CAAC,IAAM,sBAAsB,GAAG,UAAC,KAAyB;IAE5D,IAAA,2CAAiB,EACjB,yCAAgB,EAChB,qCAAc,EACd,iCAAY,EACZ,2BAAS,CACD;IAGV,IAAI,CAAC,iBAAiB,IAAI,cAAc,EAAE;QACxC,OAAO,mBAAmB,CAAC,gBAAgB,EAAE,SAAS,EAAE,YAAY,CAAC,CAAC;KAGvE;SAAM,IAAI,iBAAiB,EAAE;QAC5B,OAAO,aAAa,CAAC,KAAK,CAAC,CAAC;KAG7B;SAAM;QACL,OAAO,mBAAmB,CAAC,gBAAgB,EAAE,SAAS,CAAC,CAAC;KACzD;AACH,CAAC,CAAC;AAEF,MAAM,CAAC,IAAM,aAAa,GAAG,UAC3B,QAAsD;IAEtD,IAAM,IAAI,GAA6B,EAAE,CAAC;IAC1C,QAAQ,CAAC,OAAO,CACd,QAAQ,EACR,UAAA,KAAK,IAAI,OAAA,KAAK,IAAI,IAAI,CAAC,IAAI,CAAC,KAA0B,CAAC,EAA9C,CAA8C,CACxD,CAAC;IACF,OAAO,IAAI,CAAC;AACd,CAAC,CAAC;AAEF,MAAM,CAAC,IAAM,kBAAkB,GAAG,UAChC,QAAkC,EAClC,GAAW,IACR,OAAA,QAAQ,CAAC,MAAM,CAAC,UAAA,KAAK,IAAI,OAAA,KAAK,CAAC,GAAG,KAAK,GAAG,EAAjB,CAAiB,CAAC,EAA3C,CAA2C,CAAC\"}","dts":{"name":"/Users/mattperry/Sites/popmotion/packages/react-pose/utils/children.d.ts","text":"/// <reference types=\"react\" />\r\nimport * as React from 'react';\r\nexport interface MergeChildrenProps {\r\n    incomingChildren: Array<React.ReactElement<any>>;\r\n    displayedChildren: Array<React.ReactElement<any>>;\r\n    isLeaving: Set<string>;\r\n    removeFromTree: (key: string) => void;\r\n    preEnterPose: string;\r\n    enterPose: string;\r\n    exitPose: string;\r\n    flipMove: boolean;\r\n    animateOnMount: boolean;\r\n}\r\nexport declare const handleIncomingChildren: (props: MergeChildrenProps) => React.ReactElement<any>[];\r\nexport declare const makeChildList: (children: React.ReactElement<any> | React.ReactElement<any>[]) => React.ReactElement<any>[];\r\nexport declare const removeFromChildren: (children: React.ReactElement<any>[], key: string) => React.ReactElement<any>[];\r\n"}}
