!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.framesync={})}(this,function(e){"use strict";var n=0,t="undefined"!=typeof window&&void 0!==window.requestAnimationFrame?function(e){return window.requestAnimationFrame(e)}:function(e){var t=Date.now(),o=Math.max(0,16.7-(t-n));n=t+o,setTimeout(function(){return e(n)},o)},o=function(){};"production"!==process.env.NODE_ENV&&(o=function(e,n){if(!e)throw new Error("Hey, listen! ".toUpperCase()+n)});var r;!function(e){e.Read="read",e.Update="update",e.Render="render",e.PostRender="postRender",e.FixedUpdate="fixedUpdate"}(r||(r={}));var c=1/60*1e3,a=!0,i=!1,u=!1,d={delta:0,timestamp:0},f=[r.Read,r.Update,r.Render,r.PostRender],s=function(e){return i=e},p=f.reduce(function(e,n){var t,r,c,a,u,d,f,p,l,m=(t=s,r=[],c=[],a=0,u=!1,d=0,f=new WeakSet,p=new WeakSet,l={cancel:function(e){var n=c.indexOf(e);f.add(e),-1!==n&&c.splice(n,1)},process:function(e){var n,o;if(u=!0,r=(n=[c,r])[0],(c=n[1]).length=0,a=r.length)for(d=0;d<a;d++)(o=r[d])(e),!0!==p.has(o)||f.has(o)||(l.schedule(o),t(!0));u=!1},schedule:function(e,n,t){o("function"==typeof e,"Argument must be a function");var i=t&&u,d=i?r:c;n&&p.add(e),-1===d.indexOf(e)&&(d.push(e),i&&(a=r.length))}});return e.sync[n]=function(e,n,t){return void 0===n&&(n=!1),void 0===t&&(t=!1),i||w(),m.schedule(e,n,t),e},e.cancelSync[n]=function(e){return m.cancel(e)},e.steps[n]=m,e},{steps:{},sync:{},cancelSync:{}}),l=p.steps,m=p.sync,h=p.cancelSync,y=function(e){return l[e].process(d)},v=function(e){i=!1,d.delta=a?c:Math.max(Math.min(e-d.timestamp,40),1),a||(c=d.delta),d.timestamp=e,u=!0,f.forEach(y),u=!1,i&&(a=!1,t(v))},w=function(){i=!0,a=!0,u||t(v)};e.default=m,e.cancelSync=h,e.getFrameData=function(){return d},Object.defineProperty(e,"__esModule",{value:!0})});
